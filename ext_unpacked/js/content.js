!function(){"use strict";const e=new class{constructor(){Object.defineProperty(this,"addressDataCache",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}setSeen(e){this.addressDataCache.set(e,{fetched:!1})}getData(e){var t=e;return this.addressDataCache.get(t)}seen(e){return this.addressDataCache.has(e)}fetchAddressData(e){return window.chrome.runtime.sendMessage({smetana:!0,command:"fetch_addresses_data",address:e}).then((t=>{let a=0;for(var n of(console.log("response for fetch_addresses_data: ",t),t.items)){const t=e[a],s=this.addressDataCache.get(t);let o={data:n.info,address:null==s?void 0:s.address,lastUpdated:new Date,fetched:!0};this.addressDataCache.set(t,o),a+=1}return t}))}fetchAddressesStateFromHistory(e){return window.chrome.runtime.sendMessage({smetana:!0,command:"fetch_addresses_state",address:e}).then((e=>{var t,a,n;for(var s of(console.log("got a response from background worker :",e),e)){let e={data:{context_slot:null===(t=s.LastData)||void 0===t?void 0:t.context_slot,data:null===(a=s.LastData)||void 0===a?void 0:a.data,executable:!1,lamports:null===(n=s.LastData)||void 0===n?void 0:n.lamports,owner:""},address:s.Address,lastUpdated:new Date,fetched:!0};this.addressDataCache.set(s.Address.address,e)}return e}))}};function t(e){const t=document.querySelector(".smetana-popup-iframe");if(t)t.src=e;else{const t=document.createElement("iframe");t.className="smetana-popup-iframe",t.src=e,new Promise((e=>t.addEventListener("load",e))).then((e=>{console.log("parent iframe loaded. run amimation")}))}}var a=function(e,t,a,n){return new(a||(a=Promise))((function(s,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function d(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(r,d)}l((n=n.apply(e,t||[])).next())}))};const n=new Set(["ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL","So11111111111111111111111111111111111111112","TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA","11111111111111111111111111111111"]),s=new Map([["explorer.solana.com","https://explorer.solana.com/address/"],["solscan.io","https://solscan.io/account/"],["solana.fm","https://solana.fm/address/"]]);var o,r=(o=window.MutationObserver,function(e,t){if(e&&1===e.nodeType){if(o){var a=new o(t);return a.observe(e,{childList:!0,subtree:!0}),a}null!=window.addEventListener&&(e.addEventListener("DOMNodeInserted",t,!1),e.addEventListener("DOMNodeRemoved",t,!1))}});let d=!0;function l(e,n){var s,o;for(var r of e){var l=r.href;let e=new URL(l).pathname.split("/"),i=e[e.length-1],u=n.getData(i);if(null==r.querySelector(".smetanaExplorer")){const e=document.createElement("span");e.className="smetana-btn",e.onclick=function(e){return a(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation();const a=e.clientX>window.innerWidth/2;d=a;let n=document.querySelector(".smetana-popup-iframe"),s=document.querySelector(".smetana-splash");const o=[i];t(c+"#addr_view="+JSON.stringify(o)),a?(n.style.right="",n.style.left="-500px"):(n.style.left="",n.style.right="-500px"),n.style.display="block",s.style.display="block",setTimeout((()=>{s.style.opacity="0.1",a?n.style.left="0px":n.style.right="0px"})),document.querySelector(".addressValue").innerText=i,document.querySelector(".popup-data").innerText=JSON.stringify(u),document.querySelector(".getFresh").setAttribute("data-id",i)}))},e.classList.add("smetanaExplorer");let n=null==u?void 0:u.address;if(n){let e=null==n?void 0:n.label;e&&(r.style.color=null!==(o=null===(s=null==u?void 0:u.address)||void 0===s?void 0:s.labelColor)&&void 0!==o?o:"",r.innerText=e)}e.innerText="S",r.prepend(e)}}}function i(e,t,a){if(!(a&&a instanceof HTMLElement))return;const o=s.get(e);if(null!=o){var r=a.querySelectorAll("a");if(null!=r){var d=[],i=[];for(var c of r){var u=c.href;if(u.startsWith(o)){let e=new URL(u).pathname.split("/"),a=e[e.length-1];if(!n.has(a)){if(i.push(c),t.seen(a))continue;t.setSeen(a),d.push(a)}}}i.length>0&&(d.length>0?(console.log(`fetch this addrs: ${d.length}`,d),t.fetchAddressesStateFromHistory(d).then((()=>{l(i,t)}))):l(i,t))}else console.log("no links found")}else console.warn("unknown/unsupported domain: ",e)}const c=chrome.runtime.getURL("index.html");document.addEventListener("DOMContentLoaded",(function(){const a=document.querySelector("body");document.body.insertAdjacentHTML("beforeend",'<iframe class="smetana-popup-iframe" allow="clipboard-read; clipboard-write" ></iframe><div class="smetana-splash"></div><div class="smetana-popup" > <div class="smetana-popup-content" ><div class="popup-button inactive addressValue"></div><div class="popup-button getFresh" data-id="">GET</div><div class="popup-button">+fav</div><div class="popup-button">config</div></div><div class="popup-data"></div></div>'),t(c);{let t=document.querySelector(".getFresh"),a=document.querySelector(".popup-data"),n=document.querySelector(".smetana-popup-iframe"),s=document.querySelector(".smetana-splash");s.addEventListener("click",(()=>{s.style.opacity="0",d?(n.style.right="",n.style.left="-500px"):(n.style.left="",n.style.right="-500px"),setTimeout((()=>{s.style.display="none",n.style.display="none"}),300)})),null==t||t.addEventListener("click",(function(n){const s=null==t?void 0:t.getAttribute("data-id");e.fetchAddressData([s]).then((e=>{a.innerText=JSON.stringify(e[0])}))}))}const n=window.location.host;r(a,(function(t){for(var a of t)for(var s of a.addedNodes)i(n,e,s)}))}))}();